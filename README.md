# PenTest Plus - Final Assessment Review

### Agreements/Scopr

- **The Master Service Agreement (MSA)** is a contract that establishes guidelines for any business documents executed between two parties. It can be used to cover recurring costs and any unforeseen additional charges.

- **The Statement of Work (SOW)** is a document that defines the expectations for a specific business arrangement. It typically includes a list of deliverables, responsibilities of both parties, and others.

- **A service-level agreement (SLA)** is a contract that outlines the detailed terms under which a service is provided, including reasons the contract may be terminated.


### OWASP Top 10

A,B,C,2 I,4 S,V

    - Authentication and Identification Failures
    - Broken Access Control
    - Cryptographic Failures
    - Injection
    - Insecure Design
    - Security Misconfiguration
    - Software and Data Integrity Failures
    - Security Logging and Mpnitoring Failures
    - SSRF - Server Side Reque4st Forgery
    - Vulnerable and Outdated components


### Types of Attacks

- **An Advanced Persistent Threat (APT)** is a type of threat in which an unauthorized user gains access to a system or network and remains undetected for an extended period. During this time, they typically exfiltrate data or perform other malicious activities.

- **In a server-side request forgery (SSRF) attack**, an attacker takes advantage of the trust established between the server and the resources it can access, including itself.

- **In a cross-site request forgery (XSRF/CSRF)** attack, an attacker takes advantage of the trust established between an authorized user of a website and the website itself.

- **Session fixation attack**  - **Impersonation** -which requires the user to authenticate with a known session identifier that the threat actor will then use for impersonation.

- **XSS (Cross Site Scripting)** - 

    A cross-site scripting (XSS) attack injects malicious    code into vulnerable web applications. XSS does not target the application directly. Instead, XSS targets the users of a web application.

    A successful XSS attack can cause reputational damages and loss of customer trust, depending on the scope of the attack. Here are common examples:

    An XSS attack can employ a Trojan horse program to modify the content on a site, tricking users into providing sensitive information. 
    Successful XSS attacks can reveal session cookies, which allow cybercriminals to impersonate real users and use their accounts.


    - ```sample code....```

- **On path/MITM (Man In The Middle)** - on-path attack is an SSL/TLS downgrading/stripping attack


    - A malicious actor sits between a web client and server and creates a secure HTTPS session with the server.
    The malicious actor will then force the client to accept either a cleartext HTTP session or a downgraded HTTPS session with a more vulnerable version of SSL/TLS.
    The malicious actor will run some type of sniffer that can collect credentials as the user logs on and communicates with the server.

    - With **an on-path attack** a malicious actor is in the middle of a communication channel and is able to intercept all traffic. This is generally done by using either a spoofing or cache poisoning strategy, such as one of the following:

        - **Domain Name System (DNS) cache poisoning** sends bogus records to a DNS resolver. When the victim requests an IP address, the DNS server will send the wrong IP address. That will redirect traffic to the malicious actor’s IP address instead of the web server’s IP address.
        
        - **Address Resolution Protocol (ARP)** spoofing transmits spoofed ARP messages out on the LAN. The spoofed messages falsely report a malicious actor’s MAC address as being the victim's address. Similar to a DNS cache poisoning attack, this will redirect traffic to the malicious actor instead of the victim’s MAC address. 

    - **Responder** is a on-path type tool that can be used to exploit name resolution on a Windows network. It is designed to intercept and poison LLMNR and NBT-NS requests,

    - ```sample code....```

    - **Password Attacks** 

        - **Kerberoasting**

        One method of obtaining a hash is by using Kerberoasting. In this attack, the malicious actor will do the following:

        Get user Service Principal Names (SPN), which will identify all accounts that are candidates for Kerberoasting.
        
        From the list of SPNs, get the service tickets of an interesting target, such as a server.
    
        Dump out the service ticket, which is encrypted with the NTLM hash of the requested service account.
        Crack the account's plaintext password offline.

        - **Passing the Hash**
        
        One attack that uses a hash is a New Technology LAN Manager (NTLM) relay attack. In this case, the malicious actor doesn’t try to crack the password but instead will use the hash in an attack called pass the hash (PtH).

- **Deauthentication Attack** - 
Deauthentication attacks are used in the service of an evil twin, replay, cracking, denial of service, and other attacks. you use this to increase your chances of capturing a handshake

- **Exploit chaining** is the act of using multiple exploits to form a larger attack. Success of the attack will depend on all exploits doing their part. Using multiple forms of attacks in a distributed nature makes them complex and difficult to defend against.

    Chained exploits can either run consecutively, with each depending on the previous exploit to complete, or they can run in parallel, where each part would have to be in place and complete for the final attack or payload to succeed.

- **SSL Stripping Attack** - An SSL stripping attack, also known as an **HTTP downgrade attack**,** forces the client to communicate with the web server in plain text (unencrypted) over HTTP instead of HTTPS.

Some examples of exploit chaining include:
 - A Metasploit exploit that results in a user-level shell, followed by a local privilege escalation attack to give the shell system-level privileges.

- A module that runs a SQL injection, authentication bypass, file upload, command injection, and privilege escalation to finally give the attacker a root level shell.

- Physically (or electronically) breaking into a private network, planting a malicious device, then using that device to discover and attack vulnerable systems.

- Distracting a security guard so a colleague can tamper with a camera or alarm system while another colleague breaks into a private office to steal important documents.

- **Cloud Attacks**
    - **Malware injection attack:** In this attack, a malicious actor injects malicious code into an application. Common attacks can include SQL injection (SQLi) and Cross Site Scripting (XSS). In addition, the service can fall victim to a wrapper attack, which wraps and conceals malicious code, in order to bypass standard security methods.

    - **Side-channel attacks**: Also called a sidebar or implementation attack, this exploit is possible because of the shared nature of the cloud infrastructure, especially in a PaaS model. In this attack, the hardware leaks sensitive information such as cryptographic keys, via a covert channel, to a potential attacker.

    - **Direct-to-origin attacks (D2O)** Many organizations seek to reduce the threat of a DDoS attack by using methods such as reverse proxies in front of the web servers. This insulates the servers from a possible attack as the malicious actor is unable to penetrate the defenses. However, in a D2O attack, malicious actors circumvent this protection by identifying the origin network or IP address, and then launching a direct attack.


- A **Cold boot attack** can be used by an attacker who has physical access to a computer whose **hard drive is encrypted**

    - ```sample code....```

- A **SQL injection** poses the most direct and more impactful threat to an organization's database. A SQL injection could allow the attacker to execute remote commands on the database server and lead to sensitive information disclosure.
    - ```sample code....```
- A **Buffer overflow attack**  attempts to overwrite the memory buffer to send additional data into adjacent memory locations. A buffer overflow attack might target a database server, but it isn't intended to disclose information directly. Instead, a buffer overflow attack may be used to gain initial access to a server and allow for other malicious code running. 

    - ```sample code...```

- A **Denial of service** targets the availability of the information by attempting to take the server offline. A cross-site scripting attack typically is focused on the user, not the server or database.

- A **Chained exploit** because it combines several programs into one, including writing to a temporary file, netcat usage, and FTP usage. Chained exploits integrate more than one form of attack to accomplish their goal.

    - ```sample code...```

- **Deauthentication attacks** are used in the service of an evil twin, replay, cracking, denial of service, and other attacks. A deauthentication attack will boot the victim(s) from an AP and force them to reauthenticate, causing the victim to generate the required traffic needed for the malicious actor to capture the handshake.

- **A slowloris attack** - keeps multiple fake web connections open for as long as possible until the maximum number of allowed connections is reached.

### Ports
---


- **SMTP** - ```25```
- **RCP** - ```135```
- **SMB** - ```139 or 445```
- **LDAP** - ```389``` Active Directory
- **RPC** - ```111```
- **NETBIOS** - ```445```
- **Printer** -  ```515``` is used as an LPR/LPD port for most printers and older print servers. 
- **Printer** - ```631`` is used for IPP for most modern printers and CUPS-based print servers. 
- **Printer** - ```9100``` is used as a RAW port for most printers and is also known as the direct-IP port.
- **RDP** - ```3389``` port used for the Remote Desktop Protocol. 
- **MySQL** -```3306```
- **IMAP over SSL** - ```993``` 
### NMAP Basics
---

A defaul NMAP Scan Does This:
- **Address Resolution Protocol (ARP)** requests are sent to hosts to obtain Media Access Control (MAC) address details. The MAC address can be used for purposes such as access control.

- **ICMP type 13** By default, a Nmap scan will use the timestamp, which is provided message for ICMP type 13, of 32 bits of milliseconds since midnight UT during host discovery.

### NMAP Commands
---
- ```-O ``` - OS Detection

- ```-sA```- TCP ACK Scan to bypass firewall

- ```-sT``` - Full TCP Connect 3 way handshake

- ```-sX``` - Christmas tree FIN,PSH, URG

- ```-sU``` - UDP Scan

- ```-sF``` - The -sF option sends a TCP FIN to bypass a non-stateful firewall.

- ```-oN``` - Normal output (-oN) is similar to interactive; however, with this format, you can save the results of an Nmap scan to a text file for later analysis. 

- ```-iL``` option will scan each of the listed server's IP addresses. 
- ```-oG```option will save the results in a greppable format to the file results.txt while still displaying the normal results to the shell. 
- ```-sL``` will only list the servers to scan, but it will not scan them. 
- ```-oX``` is for outputting the results to a file in an XML format.

- ```-sV ``` - **Banner Grabbigng** - Version Detection. It performs version detection on the open ports that are found. In its simple form, this process is generally known as banner grabbing.

- ```-sY``` An SCTP Initiation Ping uses the Stream Control Transmission Protocol (SCTP), an alternative to using either a TCP or UDP scan to see if a host is alive. This scan requires using the -sY option.

- ```-sV --script vulners``` scan automation to find vulnerabilities using built in scripts 

- ```nmap ipaddress``` By default, Nmap will perform a TCP scan. 

- ```TCP SYN (synchronize)``` Default action- packet starts a communication session with a host by using TCP to initiate a conversation. 

- ```-PU``` A UDP protocol scan can be initiated by using the -PU for port scanning.

- ```-sS``` Stealth Scan
    - A stealth scan uses techniques that try to exploit the expected behavior of TCP. When used alone, the scans may have limited effectiveness. Using other scans in conjunction can fill in the gaps of information.
    
    - A stealth scan in noncredentialed that uses fewer permissions, and many times can only find missing patches or updates.

#### NMAP Responses

- **Open** - Nmap reports that a port is open by making a valid connection to the system and to the port itself. When open, the system responds to any probes.

- **Closed** - When a port is closed, probes reach the system but the port itself is not reachable.

- **Filtered** filtered port is reported by Nmap when it is concluded that the port is being blocked by a firewall.

- **Unfiltered** - An unfiltered port is reported when the system and the port are accessible, however, Nmap is unable to determine if the port is open or closed.

### Scripts

---

- **PowerShell** - keyword - (**Write-Host** )to output text to the display. 
    - ```Write-Host``` -
    - ```$Variable = Value```
    - ```CustomerName = Jason```
    - ```Set-Variable``` 
    - ```$tempArray```
    - ```$a -eq $b``` a is equal to b
    - ```$a -ne $b``` a is not equal to b
    - ```$a -gt $b``` a is greater than b
    - ```$a -ge $b``` a is greater than or equal to b
    - ```$a -lt $b``` a is less than b
    - ```$a -le $b``` a is less than or equal to b
    - ```if elseif  else``` condition
    - ```for Write-Host```
    - ```Do While```
    - ```Do Until```
    - ```Read-Host```
    - ```Write-Outpout```   
    - ```Get-This```
    - ``` Select-That```
    - ```>``` overwrites
    - ```>>```appends
- **Python** - keywords - (**print**) to output text to the display. 
    - **#** needed to comment on every line, not text block based
    - ```Vendor = "CompTia"``` - treated as string
    - ```Vendor = 'CompTia'``` - treated as string
    - ```a == b``` - is equal to
    - ```a != b``` - is not equal to
    - ```a <> b``` is not equal to
    - ```print``` 
    - ```if else```
    - variabless without **$** and **_**

- **Bash** - keyword  - (**echo**) to output text to the display. 
    - **When using Bash for scripting in Linux, a variable is not designated with a leading $. A leading $ is required when using PowerShell in a Windows environment.

    -  ```my_str="Password"  ``` - BASH
    - ```$my_str = "Password"  ``` - Powershell
    - ```variable=value``` - BASH
    - ```$CustomerName``` - Call a variablein BASH
    - ```declare -i``` - BASH
    - ```declare -r``` - BASH
    - ```temparray=(value, value2, value3)``` - BASH
    - ```if then else fi``` - BASH
    - ```for value in do, done```- BASH
    - ```while do none``` - BASH
    - ```-until do done``` - BASH

- **PERL** 
    - #!/bin/perl
    -# comment a whole line
    - ```$variabl = value:```
    - all commands end with ```;```
    - ```@tempA Array =```
    - ``` if ($a == $b)``` - is equal to
    - ``` if ($a >= $b)``` - is great than or equal to b
    - ``` if ($a -ne $b)``` - is not equal to b
    - ``` if ($a -gt $b)``` - is greater than b
    - ``` if ($a -ge $b)``` - is greater than or equal to b
    - ``` if ($a -lt $b)``` - is less than b
    - ``` if ($a -le $b)``` - is less than or equal to b
    - ```open```
    - ```sub```

When scripting in Bash, there is strict use of the equals sign (=). In Bash, the equals sign must not have a leading or trailing space, also known as whitespace.

The use of the underscore character (_) is not restricted in Bash when using it as part of a variable name.

---

- **Pseudocode** is a made-up language used to show flow and logic but is not based on any programming or scripting language. Pseudocode can be used to easily illustrate the logic of a script.

- **Operators** - are used in code to perform calculations such as mathematical calculations.

- **A tree**  has the root at the top, and the "branches" go down, with a "leaf" object at the end of a branch.

- **Flow Control** - Controlling the flow of instructions (flow control) enables programmers to write a script so that it can follow one or more paths based on certain circumstances.

---
### Scenario 1
---

#### Bind Shell - Setup listener on target first

![](./images/MaintainpersistentScenario1.png)

![](./images/MaintainpersistentScenario2.png)

---
### Scenario 2
---
![](./images/scenario1.png)

---
### Scenario 3 - Communication Triggers

![](./images/CommTriggers.png)
---

![](./images/CommTriggers.png)

---
### Scenario 4 - Administrative
---

![](./images/admin1.png)

---
### Scenario 5
---

![](./images/code1.png)

---
### Scenario 6- Wireless
---

![](./images/wireless1.png)

---
### Scenario 7 - Cloud Attacks
---

**Note-** a Side-Channel attack leaks cryptograpic keys

![](./images/cloud1.png)

---
### Scenario 8 - Covert Channels
---

![](./images/covert2.png)

![](./images/covert1.png)

---
### Senario 9 - NMAP Scanning
---

![](./images/nmap1.png)

![](./images/nmap2.png)

---
### Scenario 10 - Human Psyche
---

![](./images/psyche1.png)

---
### Secanrio 11 - OSINT
---

![](./images/osint.png)

---
### Scenario 12 - Environmental Considerations
---

![](./images/image3.png)

![](./images/image4.png)

---
### Methodologies
---

- **(OWASP)** The Open Web Application Security Project (OWASP) is an organization aimed at increasing awareness of web security and provides a framework for testing during each phase of the software development process. 

- **PTES** - The Penetration Testing Execution Standard (PTES) was developed by business professionals as a best practice guide for conducting penetration testing. The PTES contains seven main sections that are used to provide a comprehensive overview of the proper structure of a complete penetration test. 

    - TECHNICAL - **OSI Layer vulnerabilities** are a type of technical vulnerability that a PenTester may identify when creating a report based on the Penetration Testing Execution Standard (PTES).
    - LOGICAL - **NON-OSI vulnerabilities** are a type of logical vulnerability that a PenTester may identify when creating a report based on the Penetration Testing Execution Standard (PTES).
    - TECHNICAL - **Manually identified vulnerabilities** are a type of technical vulnerability that a PenTester may include in a report based on the Penetration Testing Execution Standard (PTES).
    - **Vulnerability classification levels** would be in a vulnerability report based on the Penetration Testing Execution Standard (PTES).
    - A PenTester will include a **Summary of Results** for the client in a vulnerability report based on the Penetration Testing Execution Standard (PTES).
    - LOGICAL - The **vulnerability type** is a logical vulnerability. When creating a report based on the Penetration Testing Execution Standard (PTES), a PenTester would include the type of vulnerability.

- **(OSSTMM)** - The Open Source Security Testing Methodology Manual (OSSTMM) was developed by the Institute for Security and Open Methodologies (ISECOM) and it outlines every area of an organization that needs testing and how to conduct the relevant tests

- **ISSAF** - The Information Systems Security Assessment Framework (ISSAF) is an open-source resource available to cybersecurity professionals. The ISSAF is comprised of documents that relate to penetration testing, such as guidelines on business continuity and disaster recovery along with legal and regulatory compliance.

---
### Network Mapping
---

- **Windows Management Instrumentation (WMI)** - to map and manage a network. WMI can help provide a system inventory that includes system statics and other information.

- **The Simple Network Management Protocol (SNMP)** - is useful for managing many devices including those that are not computer workstations or laptops.

- **The ARP (Address Resolution Protocol)** - command is a useful Windows command-line tool that can provide IP to MAC address mapping information for a host on a network.

---
### Wireless Attacks
---

- **Aircrack-ng** - **decipher encryption keys** - is the tool within the Aircrack-ng suite that would be used to attempt to decipher the encryption key of the APs. Aircrack-ng performs key cracking based on collected data, making it a suitable choice for this scenario.

    - It's suite of utilities is made up of several command-line tools used for wireless monitoring, attacking, testing and password cracking.
 
- **Airmon-ng** - **Monitor Mode** -is used to switch wireless network cards into monitor mode, which is a prerequisite for capturing data packets on your network but does not crack encryption keys itself.
 
- **Airodump-ng** - DUMP FRAMES **captuers packets** - **captures Frames** --is used to capture packets from a wireless router. While it's important for the process because it gathers the data that Aircrack-ng will analyze, it doesn't decipher encryption keys on its own. 

    - It's a tool that provides the ability to capture 802.11 frames and then use the output to identify the Basic Service Set ID (MAC address) of an access point
 
- **Aireplay-ng** - **inject frames** - is used to inject frames into wireless networks to generate traffic for later analysis. It is instrumental in certain types of attacks, but the actual cracking of encryption keys is not its function.


---
### Bluetooth
---

- **Bluesnarfing** - **Ability to Read Data** -is an aggressive attack, as a malicious actor is able to read information from a victim's Bluetooth device. Bluesnarfing is ineffective against devices that set Bluetooth in non-discoverable mode.

- **Bluejacking** is a method used by attackers to send out unwanted text messages, images, or videos to a mobile phone, tablet, or laptop using a Bluetooth connection.

- **Postman** - is a tool that provides an interactive and automatic environment used to interact and test an API.

---

### Google Hacking
---
- **link:comptia.org about** - **Link Operator** - <ins>To find a link to a specified page</ins>, the link operator is used. Searching link:comptia.org about will search for pages that link to CompTIA's website and have the text "about" on the page.

- **inanchor:about employees** When searching for anchor text, the inanchor operator is used. Searching inanchor:about employees <ins>will search for pages with the anchor text "about" and with the text "employees" on the page.</ins>

- **inurl:about employees** A URL can be searched for text with the inurl operator. Searching inurl:about employees <ins>will search for pages whose URLs include the text "about" and have the text "employees" on the page.</ins>

- **site:comptia.org about** - To search a site for text, the site operator is used. Searching site:comptia.org would be used to search CompTIA's website for the text "about."

---
### Tools
---
- **Maltego** - Maltego is an OSINT tool that is used to gather information from public resources. It has a graphical user interface (GUI) 
- **ZAP** - OWASP Zed Attack Proxy (ZAP) is the world's most widely used web application scanner. I
- **Mythic** - Mac OS
- **Patator** - Patator is a multi-purpose brute-force tool that supports several different methods, including ftp, ssh, smb, vnc, and zip passwords.

- **Metasploit Framework** is a free open-source command-line version of a popular PenTest tool. By default, it is installed with a fresh install of the popular Kali Linux image.

- **Armitage** is an intuitive **third-party GUI for the Metasploit framework.** This add-on provides the ability to avoid using the utility with command-line commands.

- **Cobalt Strike is a third-party commercial version of Armitage.** Unlike Armitage, it includes many advanced features and detailed reporting is included.

- **Metasploit Pro** is a full-featured graphical version that includes Quick Start wizards, easy vulnerability scanning and validation, phishing campaigns, and reporting. **

- **Gobuster** can discover subdomains, directories, and files by brute-forcing from a list of common names. This can provide information that was otherwise not available.

- **Wapiti** is a web application vulnerability scanner that will automatically navigate a web app looking for areas where it can inject data.

- **TruffleHog** is a Git secrets search tool. It can automatically crawl through a repository looking for accidental commits of **secrets**.

- **BeEF (Browser Exploit Framework)** focuses on **web browser attacks** by assessing the actual security posture of a target by using client-side attack vectors.

- **Mimikatz** - can be used to gather credentials by extracting key elements from memory such as cleartext passwords, hashes, and PIN codes.

- **Medusa** - is a parallel brute-forcer for network logins. Its focus is to support numerous network services that allow remote authentication.

- **Brutespray** allows for the interpretation of results from an Nmap scan to automatically start medusa against the identified open ports. It can also use results from nmap with option "-sV" to identify and target services on non-standard ports.

- **Hydra** - tool is brute force tool similar to medusa, in that it supports parallel testing of several network authentications. It comes bundled with a tool called pw-inspect.

- **Impacket** is a collection of Python classes that provide low-level program access to packets, as well as to protocols and their implementation. 

- **Empire (PowerShell Empire)** is a post-exploitation framework for Windows devices that allows the attacker to run PowerShell agents without needing powershell.exe. 

- **Hping** is a handy little utility that assembles and sends custom ICMP, UDP, or TCP packets and then displays any replies. It was inspired by the ping command but offered far more control over the probes sent. It also has a handy traceroute mode and supports IP fragmentation. Hping is particularly useful when trying to traceroute/ping/probe hosts behind a firewall that blocks attempts using the standard utilities. 


#### Timing Commands

- **T0/T1** - Slow scans, IDS evasion, rate limiting. 
    -  T0 = paranoid scan

- **T2** - Conserver bandwidth, last to use serial scanning. faster than T0 and T1

- **T3** - Default timing setting

- **T4** - Fast scan, relatively stable

- **T5** - Fasted option but unstable. Should only beused on network that can handle the speed.

#### Trafic Visibility

- **Port monitoring** - To capture all traffic on a switch port, port monitoring can be used. This typically required logging into the switch and enabling monitoring.

- **Switched port analysis (SPAN)** - To capture all traffic on a switch, an option is to use switched port analysis (SPAN). With SPAN, all ingress and egress traffic is copied between ports. This is also referred to as mirroring.

- **Promiscuous mode** - is required when trying to monitor all traffic on a network. Without this mode enabled, sniffing will not pick up all network traffic.

### Packet Crafting

- **Decoding** - the capture of the packets sent will help to determine how the test went. The Pentester can analyze traffic generated using a packet analyzer such as Wireshark.

- **Editing** a packet is similar to assembling a packet. The difference is that the packet content is modified after it was created or captured.

- **Assembling** - a packet involves the creation of the packet to be sent. This may involve setting malformed information to see how the traffic is handled by certain devices on a network.

- **Playing** in the packet crafting process is the actual release of the packet into the wild. The packet is sent or resent (if edited) on the network.


Lesson 7

---

### Engagement Related

---
- **Master Service Agreement** 
    - **Insurance** - Conducting a PenTest for an organization is a business arrangement, and all terms of the test should be clearly defined. Any general and liability insurance should be outlined if something goes wrong and damages occur.

    - **Safety guidelines and environmental concerns** - should be part of a master service agreement. Such guidelines should outline prohibited areas and the use of the facility.

    - **Project scope** - is defined within the master service agreement. The project scope is a definition of the specific work that is to be performed and completed.

- **Reconnaissance** focuses on gathering as much information about the target as possible. This process includes searching information on the Internet, using Open-Source Information Gathering Tools (OSINT).

- **Scanning** is a critical phase as it provides more information about available network resources. Scanning identifies live hosts, listening ports, and more.

- **Lessons Learned** - **New Vulns** - It is possible that the team found new unknown vulnerabilities during the testing. Additional personnel training or updated tools may be part of a lessons learned report.

- **Client follow-up** - is not part of a lessons learned report but rather a revisit to a client after testing and mitigation techniques have been implemented.

- **Mitigation implementation** - Although a Pentest team may assist, a mitigation implementation is the responsibility of the client and is not part of a lesson learned.

- **Client Acceptance** - During the formal hand-off process, confirmation from the client that they agree that the testing is complete and that they accept your findings as presented is important. This is not part of a lessons learned report.
    - includes **Cost Benefit Analysis**
    - **Attestation of findings** is the most significant component of gaining client acceptance, as the client must believe that what the PenTesters have said about their people, processes, and technology is accurate.

- **Analysis** occurs after a team has completed an exercise. A collection of the results of all activities are analyzed, and a summary is derived of the risk ratings for each.

- **Reporting** - will deliver the results and any remediation suggestions to the stakeholders, along with a realistic timeline of reducing risk and implementing corrective actions.

#### In Scope

- **Users** are an in-scope asset, as they are susceptible to social engineering, and are generally considered to be the easiest attack vector.

- **Domains and/or subdomains** within the organization are a prime target for malicious activity and are an in-scope asset. Domains and subdomains are examples such as example.com and ftp.example.com.

- **Service Set Identifiers (SSID)** can be targeted when an attacker is attempting to access a wireless network. As such, they are an in-scope asset.

#### Typically not in scope

- **Password** Passwords are dynamic in nature and can be reset at any time. The systems that provide and require the passwords would be an in-scope asset.

#### Engagement Scope/Risk

- **Risk appetite**- refers to the amount and type of potential vulnerabilities and threats the organization is willing to tolerate and endure.

- **Metrics** are quantifiable measurements of the status of results or processes. An example of a metric related to PenTesting is the criticality of vulnerability findings.

- **Measures** - are the specific data points that contribute to a metric. Values may be a percentage of systems that are susceptible to a particular vulnerability.

- **Risk rating** - is the process of assigning quantitative values to the identified risks. This is usually done by following a reference framework.

- In the United States, export controls regulate the transfer of certain services outside of the country. For example, Wireshark is a powerful open-source protocol analysis tool that falls under the U.S. encryption export regulations, and it may be illegal to use in certain countries.

#### Reporting Control Types - Post Engagement

- **Administrative controls** - are security measures implemented to monitor the adherence to organizational policies and procedures.

- **Logical controls** - automate protection to prevent unauthorized access or misuse. An example of this includes an Access Control List (ACL) that may be implemented as software or hardware.

- **Physical controls** - restrict, detect and monitor access to specific physical areas or assets. Methods may include barriers, tokens, biometrics, or other controls.

- **Technical controls** - may include Intrusion Detection System (IDS)/Intrusion Prevention System (IPS) signatures and antimalware protection. These are implemented as system hardware, software, or firmware solutions. 

### SQL Injection

---

- **SingleApostrophe** - ***```'```*** The most common method for identifying possible SQL injection vulnerabilities in a web app is to submit a single apostrophe and then look for errors. This is called the single quote method. If an error is returned, it may provide SQL syntax details.

- Certain web app APIs also allow the stacking of multiple queries within the same call. This can be useful for injecting new query types into a form's existing query type.

**Blind SQL injectio**n is injecting SQL when the web application's response does not contain the result of the query.

- Adding a time delay to a Blind SQL injection is known as time-based blind SQLi.

---

### PCI Compliance

---

**<ins>PCI DSS mandates a RoC</ins>**

- **Level 1** - merchants process over **6 million transactions annually**, which categorizes them as high-risk. The  for these merchants, requiring a formal assessment by a Qualified Security Assessor (QSA) due to the high volume of transactions.
 
- **Level 2** - merchants process 1 to 6 million transactions annually and typically complete a Self-Assessment Questionnaire (SAQ), but an acquiring bank may require an audit and ROC.
 
**<ins>No RoC Required</ins>**

- **Level 3** - merchants process 20,000 to 1 million transactions annually. They are not required to complete a RoC and typically do not choose this option.
 
- **Level 4** - merchants process fewer than 20,000 e-commerce transactions annually. They are low-risk and do not complete a RoC for PCI DSS compliance.

---

### Netcat Commands

---

#### Create Pessistent Listener

- ```-L``` option starts Netcat in the Windows-only "listen harder" mode. This mode creates a persistent listener that starts listening again when the client disconnects.

- ```-p``` option specifies the port that Netcat should start listening on in listening mode. When used in client mode, this value specifies the source port.

- ```-e``` option specifies the program to execute when a connection is made. This is useful for alerts and logging.

#### Non-persistent

- ```-l``` option starts Netcat in listen mode. This is a non-persistent mode. The default mode without this option is to act as a client.
---
### Steganography 
---
Used for files that contain a payload

- **Carrier** - must be able to pass as the original and appear harmless. A carrier might be music or an image file.

- **Payload** - can contain any number of things, such as trade secrets or command and control activity. Once the payload is hidden, no one outside of the sender and the receiver should suspect anything.

- **Tools** many tools are available that can conceal the activity. Most are freely available and have similar functions in that they can conceal and encrypt data using a wide range of carriers.



---
### Windows 
---

- **Distributed Component Object Model (DCOM)** -The Remote Procedure Call (RPC) enables inter-process communications between local and remote systems. DCOM applications use RPC as a transport mechanism. The intent is to exploit a flaw in the Distributed Component Object Model (DCOM) during the move.

- **PsExec utility** - **SMB** - uses the Server Message Block (SMB) protocol to enable the issuing of commands to a remote system across a network.

- **WinRM** - **SOAP** -Windows Remote Management (WinRM) is a technology that provides an HTTP Simple Object Access Protocol (SOAP) standard for specific remote management services on Windows systems.

- **RDP** - remote desktop protocol (RDP) is the default remote desktop service that comes with Windows systems. It does not use RPC with DCOM.

---
### Vulnerability Lifecycle  Phases

- 1.**Discover phase** - is the first step in finding a potential vulnerability that can be exploited.

- **Coordinate phase** - occurs after discovering a vulnerability. During this phase, the vulnerability is defined, listed, and published.

- **Manage phase** - is where the patch has been released. As such, the next step is to apply the patch in order to remediate or mitigate the vulnerability.

- **Document phase** - is the final phase. In this phase, the vulnerability patch has been tested, and all involved will take a moment to document what has been done. In addition, it's best to reflect on lessons learned, in order to prevent further exposure.
 
### Voice Over IP

- **SIP Protocol** at application layer
    - Port 5060  
    - A SIP INVITE cause a ring on the target endpoint and transfers caller ID data. 

- **UDP or TCP** at transport layer

#### Tools that can Spoof caller iD data:

- Inviteflood
- Viproy
- Twillo
- SIPp-DD

** SMPT2GO is an email serving API

Reference- Lesson 4

---
### Password Sanitation
---

- **Salt** - **added before hashing** A randomly generated string, known as a salt, can be added to a password before hashing. This salt can be stored along with the hashed password for verification purposes.

- **Hashing** - is a method that is used to encrypt passwords. A hashing algorithm takes a given value (password) and converts it into another value.

- **Password encryption** - uses one of a number of algorithms for protection. Otherwise, a password would be visible as clear text when transmitted across a network.
 
### DNS 

- **Recursion** - **queries results from other servers** -  **not reliable or safe** A DNS server that allows recursion and is incorrectly configured might be more exposed to unauthorized updates because it's designed to query and cache results from other servers. It could be tricked into caching and then serving unauthorized updates if it's not well-secured.
 
- **Poisoned cache** - **response to queries** - is a security concern, it is not directly related to the server's response to dynamic updates. Poisoning affects the server's response to queries, not its policy on accepting updates.
 
- **Invalid Records** - If a DNS server contains invalid records, it suggests a problem has occurred, such as incorrect manual entries or a successful attack on the server (like cache poisoning).
 
- **Authoritative** - Being authoritative does not imply a lack of authentication for dynamic updates; it's a separate aspect of DNS server behavior. An authoritative server, just like any other, should be configured to authenticate dynamic updates properly to maintain security.

#### DNS Attacks

To avoid IDS/IPS- **The DNS brute-force attack** queries a list of IPs and typically bypasses IDS/IPS systems that do not alert on DNS queries. 

### C++

- **strcpy** could allos buffer overflow. Upgrade to run ASLR

### General Questions

- **Responder** provides a fake server and relay tool that is included with Kali Linux. It responds to LLMNR, NBT-NS (NETBIOS), POP, IMAP, SMTP, and SQL queries to recover sensitive information such as user names and passwords.

- Since the penetration tester has exploited the FTP server from outside the LAN, they will need to set up a route statement in meterpreter. Metasploit makes this very simple since it also has an autoroute meterpreter script that will allow us to attack this second network through our first compromised machine (the FTP server) and then create the routes needed.

- **SNMP** uses community strings

- A **first-party hosted** target type best describes these targets since the question includes both internal (domain controller) and external (webserver) assets as part of the target scope, but both are hosted by the organization itself. First-party hosted targets are assets hosted by the client organization themselves. Third-party hosted targets are assets hosted by a vendor, partner, or cloud service provider. 

- A **pty** is a pseudo-terminal utility that is built into Python and only works on Linux systems. When running an exploit, sometimes you don't receive a fully interactive shell in return. If you receive a "dumb shell", you can use Python to spawn a pty. 

- **IP Spoofing** An on-path attack (formerly known as a man-in-the-middle attack) intercepts communications between two systems. For example, in an HTTP transaction, the target is the TCP connection between client and server. Using different techniques, the attacker splits the original TCP connection into 2 new connections, one between the client and the attacker and the other between the attacker and the server. This often uses IP spoofing to trick a victim into connecting to the attack.

- A **rainbow table** is a tool for speeding up attacks against Windows passwords by precomputing possible hashes. A rainbow table is used to authenticate users by comparing the hash value of the entered password against the one stored in the rainbow table. Using a rainbow table makes password cracking a lot faster and easier for an attacker. 

- **Policie**s are high-level statements of management intent. Compliance with policies by employees should be mandatory. An information security policy will generally contain broad statements around the various cybersecurity objectives.

- **ProxyChains** is a tool that allows a penetration tester to pivot to a new subnet, 

- **SQL Injection** - This code takes the input of “id” directly from a user or other program without conducting any input validation. This could be exploited and used as an attack vector for an SQL injection. If a malicious user can alter the ID source, it might get replaced with something like’ or ‘1’ ='1. 

- An **SSL stripping attack**, also known as an HTTP downgrade attack, forces the client to communicate with the web server in plain text (unencrypted) over HTTP instead of HTTPS

- **Transference (or sharing)** means assigning risk to a third party (such as an insurance company or a contract with a supplier that defines liabilities). 